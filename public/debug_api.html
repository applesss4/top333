<!DOCTYPE html>
<html>
<head>
    <title>API Debug</title>
</head>
<body>
    <h1>API Configuration Debug</h1>
    <div id="debug-info"></div>
    
    <script>
        const API_CONFIG = {
            isDevelopment: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1',
            isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
            get baseURL() {
                const override = (typeof window !== 'undefined' && (window.__API_BASE_URL__ || localStorage.getItem('API_BASE_URL')));
                if (override) return override;
                if (typeof window !== 'undefined' && window.location && window.location.protocol === 'file:') {
                    return 'https://top333.vercel.app/api';
                }
                if (this.isDevelopment) {
                    return 'http://localhost:3001/api';
                }
                return '/api';
            }
        };
        
        const debugInfo = document.getElementById('debug-info');
        debugInfo.innerHTML = `
            <p><strong>Hostname:</strong> ${window.location.hostname}</p>
            <p><strong>Port:</strong> ${window.location.port}</p>
            <p><strong>Protocol:</strong> ${window.location.protocol}</p>
            <p><strong>isDevelopment:</strong> ${API_CONFIG.isDevelopment}</p>
            <p><strong>baseURL:</strong> ${API_CONFIG.baseURL}</p>
            <p><strong>Full URL:</strong> ${window.location.href}</p>
        `;
        
        // 测试API调用
        async function testAPI() {
            try {
                const response = await fetch(`${API_CONFIG.baseURL}/health`);
                const data = await response.text();
                console.log('API Response:', data);
                debugInfo.innerHTML += `<p><strong>API Test:</strong> ${response.status} - ${data.substring(0, 100)}...</p>`;
            } catch (error) {
                console.error('API Error:', error);
                debugInfo.innerHTML += `<p><strong>API Error:</strong> ${error.message}</p>`;
            }
        }
        
        testAPI();
    </script>
</body>
</html>